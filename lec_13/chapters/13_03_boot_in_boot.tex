% !TEX root = ../om_metrics_13.tex

\begin{frame} % название фрагмента

\videotitle{Бутстрэп в бутстрэпе}

\end{frame}



\begin{frame}{Краткий план:}
  \begin{itemize}[<+->]
    \item Как оценить $se(\hat \theta^*_j)$, если нет готовой формулы?
    \item Свойства бутстрэпа в бутстрэпе.
  \end{itemize}

\end{frame}


\begin{frame}{Пример бутстрэп-стандартной ошибки}

Хочу использовать бутстрэп $t$-статистики при построении интервала для медианы $m$.
Не знаю никакой формулы для $se(\hat m)$.

\pause Сформировали на базе исходной выборки $y_1$, \ldots, $y_n$ очередную бутстрэп-выборку 
$y^*_1, \ldots, y^*_n$.

Нашли бутстрэп выборочную медиану $\hat m^*_j$. 

Как бы найти её стандартную ошибку $se(\hat m^*_j)$?

\pause 
Запустим \alert{бутстрэп второго уровня}!

\end{frame}

\begin{frame}{Бутстрэп второго уровня}

Перед нами очередная бутстрэп-выборка $y^*_1, \ldots, y^*_n$.

\alert{Алгоритм:}

\begin{enumerate}[<+->]
  \item Из бутстрэп выборки $y^*_1$, \ldots, $y^*_n$ построим бутстрэп-выборку \alert{второго уровня} $y^{**}_1$, \ldots, $y^{**}_n$:

  Выберем случайно $n$ наблюдений с повторениями. 
  \item Посчитаем бутстрэп медиану второго уровня $\hat m^{**}_k$.
  \item Повторим первые два шага много раз: $k = 1, \ldots, 1000$.
  \item Имея выборку $\hat m^{**}_1$, \ldots, $\hat m^{**}_{1000}$ оценим стандартную ошибку
  \[
    se(\hat m^*_j) = \sqrt{\sum_{k=1}^{1000} (\hat m^{**}_k - \bar{\hat m}^{**})^2 / (1000 - 1)}.
  \]
\end{enumerate}



\end{frame}




\begin{frame}{Резюме про бутстрэп в бутстрэпе}
  \begin{itemize}[<+->]
    \item \alert{Минус:} медленный. 
    
    Если огранизовать 10000 бутстрэп-выборок первого уровня, а для каждой из них 1000 бутстрэп-выборок второго уровня,
    то получится 10 000 000 выборок.

    \item \alert{Плюс:} Чаще точнее наивного. 
    
    При том же $n$ номинальная доверительная вероятность ближе к фактической. 
  \end{itemize}

\end{frame}